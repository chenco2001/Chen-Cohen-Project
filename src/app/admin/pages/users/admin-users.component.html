<section class="page">
  <header class="head">
    <div class="kicker">Admin</div>
    <h1 class="title">Users</h1>
    <p class="sub">Manage registered users</p>
  </header>

  <p class="state" *ngIf="loading">Loading users…</p>
  <p class="error" *ngIf="error">{{ error }}</p>

  <div class="tableWrap" *ngIf="!loading && users.length">
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Email</th>
          <th>Role</th>
          <th class="right">Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let u of users">
          <td>{{ u.id }}</td>

          <td class="userCell">
            <img class="avatar" [src]="u.imageUrl || u.image || 'assets/user/male.png'" alt="avatar" />
            <div class="uInfo">
              <div class="uName">{{ u.fullName || '—' }}</div>
              <div class="uMeta">{{ u.gender }} • {{ u.birthDate }}</div>
            </div>
          </td>

          <td>{{ u.email }}</td>

          <td>
            <span class="pill admin" *ngIf="isSuperAdmin(u)">SUPER ADMIN</span>

            <select
              *ngIf="!isSuperAdmin(u)"
              class="roleSelect"
              [value]="u.role || 'user'"
              (change)="changeRole(u, $any($event.target).value)"
            >
              <option value="user">User</option>
              <option value="admin">Admin</option>
            </select>
          </td>

          <td class="right">
            <button
              class="btnDanger"
              type="button"
              (click)="deleteUser(u)"
              [disabled]="isAdmin(u)"
            >
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <p class="state" *ngIf="!loading && !users.length">No users found.</p>
</section>